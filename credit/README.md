# üí∞ –ú–æ–¥—É–ª—å –ö—Ä–µ–¥–∏—Ç–æ–≤ –î–æ–≤–µ—Ä–∏—è (Credit)

–ú–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–æ–π –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–æ–≤–µ—Ä–∏—è, P2P –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏, escrow-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –±–æ–Ω—É—Å–Ω—ã–º–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è–º–∏.

## üìã –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### FR4.1: –°–∏—Å—Ç–µ–º–∞ –±–∞–ª–∞–Ω—Å–∞
- –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å: 100 –∫—Ä–µ–¥–∏—Ç–æ–≤
- –ú–∏–Ω–∏–º—É–º: 0, –ú–∞–∫—Å–∏–º—É–º: 10,000 –∫—Ä–µ–¥–∏—Ç–æ–≤
- –î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è: 1,000 –∫—Ä–µ–¥–∏—Ç–æ–≤
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—ã–π –∏ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∞–ª–∞–Ω—Å (escrow)

### FR4.2: P2P –ø–µ—Ä–µ–≤–æ–¥—ã
- –ü–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (1-1,000 –∫—Ä–µ–¥–∏—Ç–æ–≤ –∑–∞ –æ–ø–µ—Ä–∞—Ü–∏—é)
- –î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç: 5,000 –∫—Ä–µ–¥–∏—Ç–æ–≤
- –ö–æ–º–∏—Å—Å–∏—è: 5% (–º–∏–Ω–∏–º—É–º 1 –∫—Ä–µ–¥–∏—Ç)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤

### FR4.3: Escrow-—Å–∏—Å—Ç–µ–º–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏
- –ü–µ—Ä–µ–≤–æ–¥ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
- –í–æ–∑–≤—Ä–∞—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—é –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ
- –°—Ç–∞—Ç—É—Å—ã: RESERVED, RELEASED, RETURNED, DISPUTED

### FR4.4: –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É, –¥–∞—Ç–µ, –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—É
- –¢–∏–ø—ã: TRANSFER, TASK_REWARD, SYSTEM_FEE, REFUND, BONUS

### FR4.5: –ë–æ–Ω—É—Å–Ω—ã–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: 100 –∫—Ä–µ–¥–∏—Ç–æ–≤
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è: 50 –∫—Ä–µ–¥–∏—Ç–æ–≤
- –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–≥–∞: 25 –∫—Ä–µ–¥–∏—Ç–æ–≤
- –ü–µ—Ä–≤–∞—è –∑–∞–¥–∞—á–∞: 50 –∫—Ä–µ–¥–∏—Ç–æ–≤

## üöÄ API Endpoints

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–º

#### GET `/api/credits/{userId}/balance`
–ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**Response:** 200 OK
```json
{
  "id": 1,
  "userId": 1,
  "availableBalance": 250.0,
  "reservedBalance": 100.0,
  "updatedAt": "2025-10-31T22:00:00"
}
```

### P2P –ø–µ—Ä–µ–≤–æ–¥—ã

#### POST `/api/credits/{userId}/transfer`
–ü–µ—Ä–µ–≤–æ–¥ –∫—Ä–µ–¥–∏—Ç–æ–≤ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

**Request Body:**
```json
{
  "toUserId": 2,
  "amount": 50.0,
  "description": "–û–ø–ª–∞—Ç–∞ –∑–∞ —É—Å–ª—É–≥—É"
}
```

**Response:** 200 OK
```json
{
  "id": 1,
  "fromUserId": 1,
  "toUserId": 2,
  "amount": 50.0,
  "type": "TRANSFER",
  "status": "COMPLETED",
  "fee": 2.5,
  "timestamp": "2025-10-31T22:00:00"
}
```

**–û—à–∏–±–∫–∏:**
- `400` - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤
- `400` - –ü—Ä–µ–≤—ã—à–µ–Ω –¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- `400` - –ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞ (–º–µ–Ω—å—à–µ –º–∏–Ω–∏–º—É–º–∞ –∏–ª–∏ –±–æ–ª—å—à–µ –º–∞–∫—Å–∏–º—É–º–∞)

### –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

#### GET `/api/credits/{userId}/transactions`
–ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**Response:** 200 OK
```json
[
  {
    "id": 1,
    "fromUserId": 1,
    "toUserId": 2,
    "amount": 50.0,
    "type": "TRANSFER",
    "status": "COMPLETED",
    "fee": 2.5,
    "timestamp": "2025-10-31T22:00:00",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞ —É—Å–ª—É–≥—É"
  },
  {
    "id": 2,
    "fromUserId": null,
    "toUserId": 1,
    "amount": 100.0,
    "type": "BONUS",
    "status": "COMPLETED",
    "timestamp": "2025-10-31T20:00:00",
    "description": "–ë–æ–Ω—É—Å –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é"
  }
]
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–õ–∏–º–∏—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤:** –î–Ω–µ–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤ –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏–µ–π
- **–ê—É–¥–∏—Ç:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–æ–≤ –∏ user-agent –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π

## üìä –¢–∏–ø—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

| –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `TRANSFER` | P2P –ø–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ |
| `TASK_REWARD` | –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É |
| `SYSTEM_FEE` | –°–∏—Å—Ç–µ–º–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è |
| `REFUND` | –í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤ |
| `BONUS` | –ë–æ–Ω—É—Å–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ |
| `ESCROW_RESERVE` | –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ |
| `ESCROW_RELEASE` | –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ escrow |
| `ESCROW_RETURN` | –í–æ–∑–≤—Ä–∞—Ç escrow —Å–æ–∑–¥–∞—Ç–µ–ª—é |

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **Task –º–æ–¥—É–ª—å:** Escrow –¥–ª—è –∑–∞–¥–∞—á
- **Auth –º–æ–¥—É–ª—å:** –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- **Reputation –º–æ–¥—É–ª—å:** –ë–æ–Ω—É—Å—ã –∑–∞ –æ—Ç–∑—ã–≤—ã

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤ (–¥–ª—è –∑–∞–¥–∞—á)
```java
creditService.reserveCredits(userId, taskReward);
// –ë–∞–ª–∞–Ω—Å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è, —Å—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã
```

### –ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
```java
creditService.releaseReservedCredits(creatorId, amount);
creditService.addCredits(executorId, amount);
```

### –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–∞
```java
bonusService.awardRegistrationBonus(userId);
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Ç–∏–ø–∞ BONUS
```

