# ⭐ Модуль Репутации (Reputation)

Модуль управляет системой оценок, отзывов, расчетом Trust Score и начислением бейджей.

## 📋 Функциональные возможности

### FR6.1: Система оценок и отзывов
- 5-звездочная система с шагом 0.5
- Детальные оценки: качество (40%), сроки (30%), коммуникация (20%), цена/качество (10%)
- Текстовые отзывы (до 1000 символов)
- Публичные и приватные части отзыва
- 1 отзыв на задачу от каждой стороны

### FR6.2: Расчет Trust Score
- Факторы влияния:
  - Процент завершенных задач (25%)
  - Средняя оценка (30%)
  - Скорость ответов (15%)
  - Объем транзакций (10%)
  - Возраст аккаунта (5%)
  - Уровень верификации (10%)
  - Рекомендации сообщества (5%)
- Динамическое взвешивание
- Защита от манипуляций (±5 пунктов в день)

### FR6.3: Визуализация репутации
- Уровни: Новичок (0-29), Опытный (30-59), Эксперт (60-84), Мастер (85-100)
- Визуальные индикаторы с цветовой кодировкой
- Тренд изменения за 30 дней

### FR6.4: Бейджи и достижения
- Категории: Активность, Качество, Сообщество, Специализация
- Автоматическое начисление при достижении критериев
- Редкие бейджи за уникальные достижения

## 🚀 API Endpoints

### Управление отзывами

#### POST `/api/reviews`
Создать отзыв о пользователе

**Query Parameters:**
- `authorId` - ID автора отзыва
- `targetUserId` - ID получателя отзыва

**Request Body:**
```json
{
  "taskId": 1,
  "qualityRating": 4.5,
  "timelinessRating": 5.0,
  "communicationRating": 4.0,
  "valueRating": 4.5,
  "publicComment": "Отличная работа, выполнил в срок и качественно!",
  "privateComment": "Рекомендую для будущих проектов"
}
```

**Response:** 200 OK
```json
{
  "id": 1,
  "taskId": 1,
  "authorId": 1,
  "targetUserId": 2,
  "qualityRating": 4.5,
  "timelinessRating": 5.0,
  "communicationRating": 4.0,
  "valueRating": 4.5,
  "overallRating": 4.65,
  "publicComment": "Отличная работа...",
  "createdAt": "2025-10-31T22:00:00"
}
```

**Ошибки:**
- `400` - Вы уже оставили отзыв по этой задаче
- `400` - Оценка должна быть от 0.0 до 5.0, кратной 0.5

#### PUT `/api/reviews/{reviewId}`
Редактировать отзыв (до 24 часов после создания)

**Query Parameters:**
- `authorId` - ID автора отзыва

**Request Body:** (аналогично POST)

### Trust Score

#### GET `/api/trust-score/{userId}`
Получить Trust Score пользователя

**Response:** 200 OK
```json
{
  "id": 1,
  "userId": 1,
  "score": 75.5,
  "level": "EXPERT",
  "completionRate": 85.0,
  "averageRating": 4.5,
  "responseRate": 90.0,
  "transactionVolume": 5000.0,
  "accountAge": 365.0,
  "verificationLevel": 100.0,
  "communityEndorsements": 60.0,
  "lastUpdated": "2025-10-31T22:00:00"
}
```

#### POST `/api/trust-score/{userId}/recalculate`
Пересчитать Trust Score вручную

### Бейджи

#### GET `/api/badges/user/{userId}`
Получить список бейджей пользователя

**Response:** 200 OK
```json
[
  {
    "id": 1,
    "userId": 1,
    "type": "ACTIVITY",
    "name": "Первая задача",
    "description": "Выполнили свою первую задачу",
    "isRare": false,
    "earnedAt": "2025-10-31T20:00:00"
  },
  {
    "id": 2,
    "userId": 1,
    "type": "QUALITY",
    "name": "Идеальные отзывы",
    "description": "Получили 10 отзывов с оценкой 5.0",
    "isRare": true,
    "earnedAt": "2025-10-31T21:00:00"
  }
]
```

#### POST `/api/badges/user/{userId}/check`
Проверить и начислить новые бейджи

## 📊 Уровни репутации

| Уровень | Диапазон | Иконка | Описание |
|---------|----------|--------|----------|
| Новичок | 0-29 | 🔴 | Только начал использовать платформу |
| Опытный | 30-59 | 🟨 | Активный пользователь с хорошей репутацией |
| Эксперт | 60-84 | 🟦 | Высокий уровень доверия и активности |
| Мастер | 85-100 | 🟩 | Признанный лидер сообщества |

## 🎖️ Категории бейджей

| Категория | Примеры |
|-----------|---------|
| `ACTIVITY` | Первая задача, 10 завершенных, 100 транзакций |
| `QUALITY` | Идеальные отзывы, Быстрый исполнитель |
| `COMMUNITY` | Помощник новичков, Активный рецензент |
| `SPECIALIZATION` | Мастер программирования, Гуру дизайна |

## 🔗 Интеграции

- **Task модуль:** Отзывы после завершения задач
- **Credit модуль:** Учет объема транзакций
- **Profile модуль:** Отображение репутации в профиле

## 💡 Алгоритм расчета Trust Score

```java
score = completionRate * 0.25 +
        averageRating * 0.30 +
        responseRate * 0.15 +
        transactionVolume * 0.10 +
        accountAge * 0.05 +
        verificationLevel * 0.10 +
        communityEndorsements * 0.05;

// Ограничение изменения: ±5 пунктов в день
if (change > 5.0) score = previousScore + 5.0;
```

